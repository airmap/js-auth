<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>js-auth Example</title>
    <link rel="stylesheet" href="https://cdn.airmap.io/www-ui/latest/ui.min.css">
    <script src="examples/bundle.js"></script>
    <style>
        .header {
            font-size: 1em;
        }

        p {
            font-size: .8em;
        }
    </style>
</head>

<body>
    <div class="ui raised very padded text container center aligned segment">
        <img class="ui centered image" src="https://www.airmap.com/wp-content/themes/airmap/images/airmap_logo_dark.svg"></img>
        <h3 class="ui centered orange header">AirMap's js-auth Module Example</h3>
        <div class="ui divider"></div>
        <button id="login-btn" class="ui button" onclick="login()">Login</button>
        <div class="ui header orange">
            <code>showAuth()</code>
        </div>
        <p>Launches the Auth Modal when no valid access token is available.</p>
        <div class="ui divider"></div>
        <button id="logout-btn" class="ui button" onclick="logout()">Logout</button>
        <div class="ui header orange">
            <code>logout(redirectBoolean)</code>
        </div>
        <p>Logs out a user by removing the authenticated user token from localStorage and redirects the user (optional).</p>
        <div class="ui divider"></div>
        <button id="profile-btn" class="ui button" onclick="showProfile()">Get Profile</button>
        <div class="ui header orange">
            <code>getProfile()</code>
        </div>
        <p>Retreives a user's profile when authenticated. If no auth token exists, user will be shown the Auth Modal and no profile will be provided.
           If Auth0 (authentication provider) denies authentication, an error message will be shown and no profile will be provided.</p>
        <div class="ui divider"></div>
        <button id="profile-btn" class="ui button" onclick="isAuthenticated()">Is User Authenticated ?</button>
        <div class="ui header orange">
            <code>isAuthenticated()</code>
        </div>
        <p>Checks whether a user is authenticated, which means that they have a token and that the token is not expired.</p>
        <div class="ui divider"></div>
        <p>Visit <a href="https://github.com/airmap/js-auth">GitHub</a> for more information including Documentation.</p>
    </div>
    <script type="text/javascript">
        // Create an instance of AirMapAuth and provide it with some configuration settings
        // config is an object provided to the the AirMapAuth constructor
        // client_id: from the AirMap Developer Portal (https://dashboard.airmap.io/developer)
        // callback_url: your callback url needs to be saved on the AirMap Developer Portal (https://dashboard.airmap.io/developer)
        // logout_url: Optional url to be redirected to after logging out. Defaults to `callback_url`
        // token_name: Optional token name to be used when storing the authentication token in localStorage. Defaults to 'AirMapUserToken'
        var config = {
            client_id: '',
            callback_url: '',
            logout_url: null,
            token_name: null
        };
        var auth = new AirMapAuth(config);

        // Calls the 'showAuth' method which launches the Auth Modal
        function login() {
            auth.showAuth()
        }

        // Calls the 'logout' method which destroys a user's authenticated session
        function logout() {
            auth.logout(true)
        }

        // Calls the 'isAuthenticated' method which checks if a user's session is authenticated
        function isAuthenticated() {
            console.log(auth.isAuthenticated())
        }

        // Calls the 'showProfile' method which retrieves a user's profile (if authenticated)
        function showProfile() {
            auth.getProfile().then(response => {
                console.log(response);
            }).catch(error => {
                console.log(error);
            });
        }
    </script>
</body>

</html>
